<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://unpkg.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src https://fonts.gstatic.com; connect-src 'self';"
    />
    <title>PSM-I Practice Exam</title>
    <meta
      name="description"
      content="Professional Scrum Master I practice exam â€” 80 questions based on the Scrum Guide 2020"
    />
    <style>
      body {
        margin: 0;
        padding: 0;
        background: #0a0e1a;
      }
      #loading {
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        font-family: "DM Sans", system-ui, sans-serif;
        color: rgba(255, 255, 255, 0.5);
        font-size: 16px;
      }
      #loading.error {
        color: #f87171;
      }
    </style>
  </head>
  <body>
    <div id="root">
      <div id="loading">Loading exam...</div>
    </div>
    <script
      src="https://unpkg.com/react@18.3.1/umd/react.production.min.js"
      integrity="sha384-DGyLxAyjq0f9SPpVevD6IgztCFlnMF6oW/XQGmfe+IsZ8TqEiDrcHkMLKI6fiB/Z"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://unpkg.com/react-dom@18.3.1/umd/react-dom.production.min.js"
      integrity="sha384-gTGxhz21lVGYNMcdJOyq01Edg0jhn/c22nsx0kyqP0TxaV5WVdsSH1fSDUf5YJj1"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://unpkg.com/@babel/standalone@7.26.9/babel.min.js"
      integrity="sha384-pKNXKj7jF9BNMkQyGWg5YLfoPyqBa/gf7wjTSoTGQlwxbZB+sabJuKyOHR6JQvTd"
      crossorigin="anonymous"
    ></script>
    <script>
      // Polyfill window.storage with localStorage for standalone use
      if (!window.storage) {
        window.storage = {
          get: function (key) {
            var value = localStorage.getItem(key);
            return Promise.resolve(value ? { value: value } : null);
          },
          set: function (key, value) {
            localStorage.setItem(key, value);
            return Promise.resolve();
          },
          delete: function (key) {
            localStorage.removeItem(key);
            return Promise.resolve();
          },
        };
      }

      // Load and render the component
      fetch("psm-exam.jsx")
        .then(function (r) {
          if (!r.ok) throw new Error("Failed to load exam (" + r.status + ")");
          return r.text();
        })
        .then(function (code) {
          var browserCode = code
            .replace(
              /import\s*\{[^}]*\}\s*from\s*["']react["'];?/,
              "var { useState, useEffect, useCallback, useRef } = React;",
            )
            .replace(/export\s+default\s+/, "window.PSMExam = ");
          var transformed = Babel.transform(browserCode, {
            presets: ["react"],
          }).code;
          var script = document.createElement("script");
          script.textContent = transformed;
          document.body.appendChild(script);
          var root = ReactDOM.createRoot(document.getElementById("root"));
          root.render(React.createElement(window.PSMExam));
        })
        .catch(function (err) {
          console.error("Failed to load exam:", err);
          var el = document.getElementById("loading");
          if (el) {
            el.className = "error";
            el.textContent = "Failed to load exam. Please refresh the page.";
          }
        });
    </script>
  </body>
</html>
